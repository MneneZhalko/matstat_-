---
title: "Математична статистика. _Лабораторна робота № 6_. Побудова моделей регресії"
author: "Ihor Polynko, KN-23-1, `r format(Sys.Date(), '%Y')`"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    df_print: paged
  html_notebook:
    toc: true
    toc_float: true
    highlight: tango
fontsize: 12pt
header-includes: \usepackage[T2A]{fontenc} \usepackage[utf8]{inputenc} \usepackage[russian]{babel}
editor_options:
  chunk_output_type: console
bibliography: references.bib
---

## Постановка задачі

1. Засобами R+RStudio імпортувати файл з варіантами завдань IZ_No2.xls і для свого варіанта побудувати лінійну модель.

2. Виконати первинний аналіз лінійної моделі спочатку за допомогою графічних опцій, а потім найбільш детальний за допомогою табличних, перевірити її адекватність. У разі необхідності підібрати альтернативну
нелінійну модель і оцінити її параметри, або побудувати модель у вигляді полінома.

3. Завдання оформити у вигляді динамічного електронного документа за
допомогою Quarto та згенерувати електронний звіт у форматі html за заданим
викладачем шаблоном. Структура звіту:

  – постановка завдання;

  – короткі теоретичні відомості щодо досліджуваного розподілу та методів розрахунків;

  – детальна схема виконання лабораторної роботи з необхідними екранними візуалізаторами і поясненнями згідно з        робочим завданням, результатами аналізу;

  – висновки;

  – перелік посилань, організований за допомогою bibtex.

---

## Розв’язок задачі


```{r, echo=TRUE}

# Завантаження бібліотек
library(readxl)
library(ggplot2)

# Імпорт даних з файлу
data <- read_excel("IZ_No2.xls")  # Заміни на шлях до свого файлу

# Перевірка структури даних
str(data)
```

```{r, echo=TRUE}
# Вибір необхідних стовпців для X та Y за індексацією
X <- data[[6]]  # Колонка 6 для X
Y <- data[[31]]  # Колонка 31 для Y

# Перевірка, чи коректно вибрано X та Y
head(X)
head(Y)
```

```{r, echo=TRUE}
# Побудова лінійної моделі
model <- lm(Y ~ X)

# 3. Первинний графічний аналіз
# Графік залишків
ggplot(data, aes(x = X, y = Y)) +
  geom_point() +
  geom_smooth(method = "lm", col = "red") +
  labs(title = "Лінійна регресія: Y на X",
       x = "X",
       y = "Y")
```

```{r, echo=TRUE}
# Аналіз залишків
par(mfrow = c(2, 2))
plot(model)
```

```{r, echo=TRUE}
# 4. Перевірка адекватності моделі
summary(model)
```

```{r, echo=TRUE}
# 5. Альтернативна модель: поліноміальна регресія (якщо необхідно)
model_poly <- lm(Y ~ poly(X, 2))  # Поліном 2-го ступеня
summary(model_poly)
```

```{r, echo=TRUE}
# Побудова графіка для поліноміальної моделі
ggplot(data, aes(x = X, y = Y)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ poly(x, 2), col = "blue") +
  labs(title = "Поліноміальна регресія: Y на X (2-й ступінь)",
       x = "X",
       y = "Y")

```

## Висновки
1. Побудова лінійної моделі: За допомогою методу найменших квадратів була побудована лінійна регресія, що описує залежність змінної Y від X. Модель виявила лінійну взаємозв'язок між цими змінними, що підтверджується коректними статистичними показниками (коефіцієнти моделі, $R^2$ тощо).


2. Графічний аналіз: Первинний графічний аналіз, зокрема побудова графіка розсіювання та лінії регресії, показав наявність певного лінійного тренду. Графік залишків також дозволив перевірити наявність структурованих відхилень, які могли б свідчити про порушення припущень моделі.


3. Перевірка адекватності моделі: За допомогою функції $summary()$ було проведено детальний аналіз моделі, включаючи статистичні тести та значення коефіцієнтів. Модель виявилась статистично значущою, однак залишки показали незначні відхилення від нормальності. Це вказує на те, що можливо існують додаткові фактори або нелінійні зв'язки, які модель не враховує.


4. Альтернативна модель: Для поліпшення моделі була протестована поліноміальна регресія другого ступеня. Результати показали кращу відповідність даним, оскільки поліноміальна модель дозволяє краще описати можливі нелінійні зв'язки між змінними.


5. Подальші кроки: Якщо залишки поліноміальної моделі також виявляться неадекватними, можна спробувати більш складні методи, такі як нелінійні моделі або моделі з взаємодією змінних. Однак, наразі поліноміальна модель виглядає найкращим вибором для моделювання цієї залежності.


## References
[@LatExSyntaxis]
[@Akinshin]