---
title: "Математична статистика. _Лабораторна робота № 5_. Дисперсійний аналіз (ANOVA)"
author: "Ihor Polynko, KN-23-1, `r format(Sys.Date(), '%Y')`"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    df_print: paged
  html_notebook:
    toc: true
    toc_float: true
    highlight: tango
fontsize: 12pt
header-includes: \usepackage[T2A]{fontenc} \usepackage[utf8]{inputenc} \usepackage[russian]{babel}
editor_options:
  chunk_output_type: console
bibliography: references.bib
---

## Постановка задачі

Маємо p груп значень випадкової величини X для кожного рівня фактора, вплив якого вивчається. Кількість спостережень для кожного рівня відповідно $q_1, q_2, ..., q_p$. За схемою однофакторного дисперсійного аналізу перевірити нульову гіпотезу $H_0: M(X_1) = M(X_2) = ... = M(X_p)$ за альтернативної $H1: M(X_1) ≠ M(X_2) ≠ ... ≠ M(X_p)$ (з надійністю $γ=0,95$), упевнившись, що виконуються класичні передумови дисперсійного аналізу: нормальність розподілу $X$ та однорідність дисперсій на кожному рівні.

Для цього необхідно виконати.

1. Перевірити нормальність розподілу випадкової величини $X$ на кожному
рівні.

2. Перевірити однорідність дисперсій за допомогою одного з критеріїв: Кохрена, Бартлета. Доцільність того чи іншого критерію визначається конкретним варіантом, що потрібно обґрунтувати.

3. За схемою однофакторного дисперсійного аналізу перевірити нульову
гіпотезу $H_0: M(X_1) = M(X_2)= ... =M(X_p)$ (з надійністю $γ=0,95$).

4. Подати результати у стандартному табличному вигляді.

5. Побудувати графік для інтервальних оцінок середніх.

---

## Розв’язок задачі


```{r, echo=TRUE}
# Генеруємо дані для аналізу
set.seed(123) # Для відтворюваності результатів
p <- 3 # Кількість рівнів фактору
q <- c(15, 20, 25) # Кількість спостережень для кожного рівня
data <- data.frame(
  X = c(rnorm(q[1], mean = 5, sd = 1),
        rnorm(q[2], mean = 7, sd = 1.2),
        rnorm(q[3], mean = 6, sd = 1.1)),
  Factor = factor(rep(1:p, times = q))
)

# Перевірка нормальності розподілу для кожного рівня фактору
library(nortest)
normality_tests <- by(data$X, data$Factor, shapiro.test)
normality_results <- sapply(normality_tests, function(x) c(p_value = x$p.value))

# Перевірка однорідності дисперсій
bartlett_test <- bartlett.test(X ~ Factor, data = data)

# Однофакторний дисперсійний аналіз
anova_result <- aov(X ~ Factor, data = data)
summary(anova_result)
```

```{r, echo=TRUE}
# Інтервальні оцінки середніх
library(ggplot2)
means <- tapply(data$X, data$Factor, mean)
sds <- tapply(data$X, data$Factor, sd)
ns <- tapply(data$X, data$Factor, length)
conf_int <- data.frame(
  Factor = as.factor(1:p),
  Mean = means,
  Lower = means - qt(0.975, ns - 1) * sds / sqrt(ns),
  Upper = means + qt(0.975, ns - 1) * sds / sqrt(ns)
)

# Побудова графіка для інтервальних оцінок середніх
ggplot(conf_int, aes(x = Factor, y = Mean)) +
  geom_point(size = 3, color = "blue") +
  geom_errorbar(aes(ymin = Lower, ymax = Upper), width = 0.2, color = "red") +
  labs(
    title = "Інтервальні оцінки середніх",
    x = "Рівні фактору",
    y = "Середнє значення"
  )
```

```{r, echo=TRUE}
# Табличний вигляд результатів
results_table <- data.frame(
  Factor = conf_int$Factor,
  Mean = round(conf_int$Mean, 2),
  Lower = round(conf_int$Lower, 2),
  Upper = round(conf_int$Upper, 2)
)
print(results_table)
```

```{r, echo=TRUE}
cat("Результати перевірки нормальності:\n")
print(normality_results)
cat("\nРезультат тесту Бартлета на однорідність дисперсій:\n")
print(bartlett_test)
cat("\nРезультати ANOVA:\n")
print(summary(anova_result))
```

## Висновки
1. Генерація даних:


Було створено три групи спостережень для аналізу з різними кількостями (15, 20, 25) та параметрами нормального розподілу (середнє та стандартне відхилення). Дані змодельовано для імітації реальних умов аналізу впливу фактора на змінну.


2. Перевірка нормальності розподілу:

Для кожного рівня фактора перевірено нормальність розподілу даних за допомогою тесту Шапіро-Уілка. Усі рівні відповідали припущенню нормального розподілу, що підтверджує виконання першої передумови дисперсійного аналізу.

3. Перевірка однорідності дисперсій:

Було використано тест Бартлетта для перевірки однорідності дисперсій. Результати показали, що дисперсії між групами можна вважати однорідними, що відповідає другій передумові дисперсійного аналізу.


4. Однофакторний дисперсійний аналіз:

Проведено однофакторний дисперсійний аналіз для перевірки нульової гіпотези про рівність середніх значень у трьох групах. Отримані результати показали, що різниця між середніми є статистично значущою (при рівні надійності 0,95), тобто вплив фактора є суттєвим.


5. Графічна інтерпретація:

Побудовано графік інтервальних оцінок середніх для кожної групи. Графічна візуалізація підтверджує результати дисперсійного аналізу, оскільки інтервали для середніх значень не перекриваються значною мірою.іпотези щодо нормальності розподілу випадкової величини. У разі менших вибірок результат може бути менш надійним.


## References
[@LatExSyntaxis]
[@Akinshin]